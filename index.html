<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="LeetCode problem preparation with organized problem lists, clean solutions, and detailed explanations.">
  <meta name="keywords" content="LeetCode, algorithms, data structures, programming, interview preparation">
  <meta name="author" content="LeetCode Prep">
  <title>LeetCode Prep</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <!-- Mobile Ribbon/Topbar -->
  <div id="mobile-ribbon">
    <button id="mobile-home-btn" class="mobile-nav-btn">
      <span class="btn-icon">üè†</span>
    </button>
    <span id="mobile-ribbon-title">LEETCODE ARTICLES</span>
    <div id="mobile-ribbon-actions">
      <button id="mobile-search-btn" class="mobile-nav-btn">
        <span class="btn-icon">üîç</span>
      </button>
      <button id="mobile-settings-btn" class="mobile-nav-btn">
        <span class="btn-icon">‚öôÔ∏è</span>
      </button>
    </div>
  </div>

  <!-- Mobile Container -->
  <div id="mobile-container">
    <!-- Mobile Breadcrumb Navigation -->
    <div class="mobile-breadcrumb-nav" id="mobile-breadcrumb-nav" style="display: none;">
      <div class="mobile-breadcrumb">
        <span id="mobile-breadcrumb-home" class="mobile-breadcrumb-link" onclick="
          showMobileLoadingAnimation(); 
          setTimeout(() => mobileRouter.navigate(''), 300);
        ">Home</span>
        <span id="mobile-breadcrumb-arrow-1" class="mobile-breadcrumb-arrow" style="display: none;"> ‚Üí </span>
        <span id="mobile-breadcrumb-list" class="mobile-breadcrumb-link" style="display: none;" onclick=""></span>
        <span id="mobile-breadcrumb-arrow-2" class="mobile-breadcrumb-arrow" style="display: none;"> ‚Üí </span>
        <span id="mobile-breadcrumb-problem" class="mobile-breadcrumb-text" style="display: none;"></span>
      </div>
    </div>
    
    <!-- Main Content Views -->
    <div class="mobile-content">
      <!-- Lists View (Home) -->
      <div id="mobile-lists-view" class="mobile-view">
        <div id="mobile-lists-sidebar">
          <ul id="mobile-lists-list"></ul>
        </div>
      </div>
      
      <!-- Problems View -->
      <div id="mobile-problems-view" class="mobile-view" style="display: none;">
        <div id="mobile-sidebar">
          <ul id="mobile-file-list"></ul>
        </div>
      </div>
      
      <!-- Content View -->
      <div id="mobile-content-view" class="mobile-view" style="display: none;">
        <div id="mobile-content">
          <div class="mobile-content-inner" id="mobile-default-content">
            <div style="text-align: center; padding: 3rem 1rem; color: #656d76;">
              <div style="display: inline-block; animation: spin 1s linear infinite; font-size: 2rem; margin-bottom: 1rem;">‚è≥</div>
              <p style="margin: 0; font-size: 0.95rem;">Loading...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Modal -->
  <div id="mobile-search-modal" class="mobile-modal">
    <div class="mobile-modal-content">
      <div class="mobile-modal-header">
        <h3>üîç Search Problems</h3>
        <span class="mobile-close-btn" onclick="closeMobileSearchModal()">&times;</span>
      </div>
      <div class="mobile-modal-body">
        <input type="text" id="mobile-search-input" placeholder="Search problems by title, number, or difficulty..." autocomplete="off">
        <div class="mobile-search-filters">
          <label><input type="checkbox" id="mobile-filter-easy" checked> Easy</label>
          <label><input type="checkbox" id="mobile-filter-medium" checked> Medium</label>
          <label><input type="checkbox" id="mobile-filter-hard" checked> Hard</label>
        </div>
        <div id="mobile-search-results"></div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="mobile-settings-modal" class="mobile-modal">
    <div class="mobile-modal-content">
      <div class="mobile-modal-header">
        <h3>‚öôÔ∏è Settings</h3>
        <span class="mobile-close-btn" onclick="closeMobileSettingsModal()">&times;</span>
      </div>
      <div class="mobile-modal-body">
        <div class="mobile-setting-item">
          <label for="mobile-theme-toggle">Theme:</label>
          <select id="mobile-theme-toggle">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="auto">Auto</option>
          </select>
        </div>
        <div class="mobile-setting-item">
          <label for="mobile-font-size">Font Size:</label>
          <select id="mobile-font-size">
            <option value="small">Small</option>
            <option value="normal" selected>Normal</option>
            <option value="large">Large</option>
          </select>
        </div>
        <div class="mobile-setting-item">
          <label for="mobile-layout-mode">Layout:</label>
          <select id="mobile-layout-mode">
            <option value="comfortable" selected>Comfortable</option>
            <option value="compact">Compact</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Feedback FAB -->
  <button id="mobile-feedback-fab" class="mobile-feedback-fab">
    <span>üí¨</span>
  </button>

  <!-- Share FAB -->
  <button id="mobile-share-fab" class="mobile-share-fab">
    <span>üîó</span>
  </button>

  <script>
    /*
    ===========================================
    MOBILE LEETCODE ARTICLES APP
    Using same core architecture as desktop version
    ===========================================
    */
    
    // Global state management (same as desktop)
    let currentLists = [];
    let currentListData = [];
    let currentListSlug = '';
    let currentMarkdownFile = ''; 
    let listSlugMap = {};
    let slugToFileMap = {};
    let isPageReload = true;
    let currentView = 'lists'; // 'lists', 'problems', 'content'
    
    // Generate URL-friendly slug from text (same as desktop)
    function createSlug(text) {
      return text
        .toLowerCase()
        .replace(/[^a-z0-9\s-]/g, '')
        .replace(/\s+/g, '-')
        .replace(/-+/g, '-')
        .replace(/^-|-$/g, '');
    }
    
    // Generate mappings from lists.json data (same as desktop)
    function generateSlugMappings(lists) {
      const slugMap = {};
      const fileMap = {};
      
      lists.forEach(list => {
        const slug = list.url || createSlug(list.name);
        
        let finalSlug = slug;
        let counter = 1;
        while (Object.values(slugMap).includes(finalSlug)) {
          finalSlug = `${slug}-${counter}`;
          counter++;
        }
        
        slugMap[list.file] = finalSlug;
        fileMap[finalSlug] = list.file;
      });
      
      return { slugMap, fileMap };
    }
    
    // Mobile Router (adapted from desktop)
    const mobileRouter = {
      init() {
        window.addEventListener('hashchange', () => this.handleRoute());
        this.handleRoute();
      },
      
      parseHash() {
        const hash = window.location.hash.substring(1);
        if (!hash) return { listSlug: null, problemSlug: null };
        
        const parts = hash.split('/');
        return {
          listSlug: parts[0] || null,
          problemSlug: parts[1] || null
        };
      },
      
      navigate(listSlug = '', problemSlug = '') {
        const newHash = listSlug ? 
          (problemSlug ? `#${listSlug}/${problemSlug}` : `#${listSlug}`) : 
          '';
        
        // Mark that we're navigating to prevent double loading animations
        this.isNavigating = true;
        
        if (window.location.hash !== newHash) {
          window.location.hash = newHash;
        } else {
          this.handleRoute();
        }
      },
      
      async handleRoute() {
        const { listSlug, problemSlug } = this.parseHash();
        
        // Don't show loading animation here if we're already showing it from navigation
        if (!this.isNavigating) {
          showMobileLoadingAnimation();
        }
        
        // Minimum loading time for consistent UX
        const loadStartTime = Date.now();
        const minimumLoadTime = 300; // 0.3s
        
        if (!listSlug && !problemSlug) {
          // Home view
          await this.showWelcome();
        } else if (listSlug && !problemSlug) {
          // List view
          await this.showList(listSlug);
        } else if (listSlug && problemSlug) {
          // Problem view
          await this.showProblem(listSlug, problemSlug);
        }
        
        // Ensure minimum load time
        const loadTime = Date.now() - loadStartTime;
        const remainingTime = Math.max(0, minimumLoadTime - loadTime);
        
        if (remainingTime > 0) {
          await new Promise(resolve => setTimeout(resolve, remainingTime));
        }
        
        this.isNavigating = false;
        isPageReload = false;
      },
      
      async showWelcome() {
        console.log('showWelcome - clearing state'); // Debug log
        currentView = 'lists';
        
        // Reset global variables when going home
        currentListSlug = '';
        currentListData = [];
        currentMarkdownFile = '';
        
        // Clear hash if not already cleared
        if (window.location.hash) {
          window.location.hash = '';
        }
        
        // Force clear breadcrumbs immediately
        const breadcrumbNav = document.getElementById('mobile-breadcrumb-nav');
        const breadcrumbList = document.getElementById('mobile-breadcrumb-list');
        const breadcrumbProblem = document.getElementById('mobile-breadcrumb-problem');
        
        if (breadcrumbNav) {
          breadcrumbNav.style.display = 'none';
          console.log('showWelcome - set breadcrumb nav display to none'); // Debug log
        }
        if (breadcrumbList) {
          breadcrumbList.textContent = '';
        }
        if (breadcrumbProblem) {
          breadcrumbProblem.textContent = '';
        }
        
        showMobileView('lists');
        
        if (currentLists.length === 0) {
          await loadMobileLists();
        } else {
          // Re-render lists without additional animation since showMobileView already animated
          renderMobileListsNoAnimation();
        }
        
        document.title = 'LeetCode Prep';
      },
      
      async showList(listSlug) {
        // Ensure lists and mappings are loaded
        if (currentLists.length === 0) {
          await loadMobileLists();
        }
        
        const fileName = slugToFileMap[listSlug];
        if (!fileName) {
          this.showError('List Not Found', `The requested list "${listSlug}" does not exist.`);
          return;
        }
        
        currentView = 'problems';
        showMobileView('problems');
        
        // Clear previous problems immediately
        document.getElementById('mobile-file-list').innerHTML = '';
        
        await loadMobileCodeListFilesNoAnimation(fileName);
        
        const listInfo = currentLists.find(l => l.file === fileName);
        document.title = `${listInfo ? listInfo.name : 'Problem List'} - LeetCode Prep`;
      },
      
      async showProblem(listSlug, problemSlug) {
        // Don't show loading animation here - it's handled by navigation
        
        // Ensure lists and mappings are loaded
        if (currentLists.length === 0) {
          await loadMobileLists();
        }
        
        const fileName = slugToFileMap[listSlug];
        if (!fileName) {
          this.showError('List Not Found', `The requested list "${listSlug}" does not exist.`);
          return;
        }
        
        currentView = 'content';
        showMobileView('content');
        
        // Load list if not already loaded
        if (currentListSlug !== listSlug) {
          await loadMobileCodeListFiles(fileName);
        }
        
        // Find and load problem
        const problem = currentListData.find(p => p.slug === problemSlug);
        if (problem) {
          document.title = `${problem.title} - LeetCode Prep`;
          await loadMobileMarkdownFile(`${problem.number}-${problem.slug}.md`);
        } else {
          this.showError('Problem Not Found', `The requested problem "${problemSlug}" does not exist in this list.`);
          return;
        }
      },
      
      showError(title, message) {
        currentView = 'content';
        showMobileView('content');
        document.getElementById('mobile-content').innerHTML = `
          <div class="mobile-content-inner">
            <h2>${title}</h2>
            <p>${message}</p>
            <p><a href="#" onclick="mobileRouter.navigate('')">‚Üê Back to Home</a></p>
          </div>
        `;
        document.title = `${title} - LeetCode Prep`;
      }
    };
    
    // Mobile view management
    function showMobileView(viewType) {
      // Hide all views
      document.querySelectorAll('.mobile-view').forEach(view => {
        view.style.display = 'none';
      });
      
      // Show target view
      const targetView = document.getElementById(`mobile-${viewType}-view`);
      if (targetView) {
        targetView.style.display = 'block';
        // Reset any existing styles from previous animations
        targetView.style.opacity = '';
        targetView.style.transform = '';
        targetView.style.transition = '';
        
        // Add coordinated animation for the entire view
        animateMobileContent(targetView, 'slide-up');
      }
      
      currentView = viewType;

      // Force immediate breadcrumb update
      setTimeout(() => {
        updateMobileBreadcrumb();
      }, 0);
    }
    
    // Mobile content animation helper functions
    function animateMobileContent(element, animationType = 'fade-in') {
      if (!element) return;
      
      // Remove any existing animation classes and inline styles
      element.classList.remove('mobile-content-fade-in', 'mobile-content-slide-in', 'mobile-content-slide-up', 'mobile-content-exit');
      element.style.opacity = '';
      element.style.transform = '';
      element.style.transition = '';
      
      // Force reflow to ensure the class removal takes effect
      element.offsetHeight;
      
      // Add the new animation class
      switch (animationType) {
        case 'fade-in':
          element.classList.add('mobile-content-fade-in');
          break;
        case 'slide-in':
          element.classList.add('mobile-content-slide-in');
          break;
        case 'slide-up':
          element.classList.add('mobile-content-slide-up');
          break;
        case 'exit':
          element.classList.add('mobile-content-exit');
          break;
      }
      
      // Remove animation class after animation completes
      setTimeout(() => {
        element.classList.remove('mobile-content-fade-in', 'mobile-content-slide-in', 'mobile-content-slide-up', 'mobile-content-exit');
      }, 350);
    }
    
    // Animate content changes in specific containers
    function animateMobileContentContainer(containerId, animationType = 'fade-in') {
      const container = document.getElementById(containerId);
      if (container) {
        // Small delay to ensure content is rendered
        setTimeout(() => {
          animateMobileContent(container, animationType);
        }, 50);
      }
    }    // Update mobile breadcrumb - simplified to use URL hash directly
    function updateMobileBreadcrumb() {
      const breadcrumbNav = document.getElementById('mobile-breadcrumb-nav');
      const breadcrumbHome = document.getElementById('mobile-breadcrumb-home');
      const breadcrumbArrow1 = document.getElementById('mobile-breadcrumb-arrow-1');
      const breadcrumbList = document.getElementById('mobile-breadcrumb-list');
      const breadcrumbArrow2 = document.getElementById('mobile-breadcrumb-arrow-2');
      const breadcrumbProblem = document.getElementById('mobile-breadcrumb-problem');
      
      // Parse current URL hash directly - don't rely on global variables
      const hash = window.location.hash.substring(1);
      
      console.log('updateMobileBreadcrumb - hash:', hash); // Debug log
      
      if (!hash) {
        // Home page - hide breadcrumbs completely and reset all elements
        console.log('Home page detected - hiding breadcrumbs'); // Debug log
        breadcrumbNav.style.display = 'none';
        breadcrumbArrow1.style.display = 'none';
        breadcrumbList.style.display = 'none';
        breadcrumbArrow2.style.display = 'none';
        breadcrumbProblem.style.display = 'none';
        breadcrumbList.textContent = '';
        breadcrumbProblem.textContent = '';
        return;
      }
      
      const parts = hash.split('/');
      const listSlug = parts[0] || null;
      const problemSlug = parts[1] || null;
      
      console.log('Breadcrumb parts:', { listSlug, problemSlug }); // Debug log
      
      if (!listSlug) {
        // Home page - hide breadcrumbs
        breadcrumbNav.style.display = 'none';
        return;
      }
      
      // Show breadcrumb navigation
      breadcrumbNav.style.display = 'flex';
      breadcrumbHome.style.display = 'inline';
      
      // Get list name from slug
      const listFile = slugToFileMap[listSlug];
      const listInfo = currentLists.find(l => l.file === listFile);
      const listName = listInfo ? listInfo.name : listSlug;
      
      if (!problemSlug) {
        // List page: Home ‚Üí List Name
        breadcrumbArrow1.style.display = 'inline';
        breadcrumbList.style.display = 'inline';
        breadcrumbList.textContent = listName;
        breadcrumbList.classList.remove('mobile-breadcrumb-link');
        breadcrumbList.classList.add('mobile-breadcrumb-text');
        breadcrumbList.onclick = null;
        
        breadcrumbArrow2.style.display = 'none';
        breadcrumbProblem.style.display = 'none';
      } else {
        // Problem page: Home ‚Üí List Name ‚Üí Problem Name
        breadcrumbArrow1.style.display = 'inline';
        breadcrumbList.style.display = 'inline';
        breadcrumbList.textContent = listName;
        breadcrumbList.classList.remove('mobile-breadcrumb-text');
        breadcrumbList.classList.add('mobile-breadcrumb-link');
        breadcrumbList.onclick = () => {
          showMobileLoadingAnimation();
          setTimeout(() => {
            mobileRouter.navigate(listSlug);
          }, 300);
        };
        
        // Get problem name from slug
        const problem = currentListData.find(p => p.slug === problemSlug);
        const problemName = problem ? problem.title : problemSlug;
        
        breadcrumbArrow2.style.display = 'inline';
        breadcrumbProblem.style.display = 'inline';
        breadcrumbProblem.textContent = problemName;
      }
    }
    
    // Show loading animation (smaller size matching FAB buttons)
    function showMobileLoadingAnimation() {
      if (currentView === 'lists' || !currentView) {
        // Home view loading
        document.getElementById('mobile-lists-list').innerHTML = `
          <li style="text-align: center; padding: 2rem; color: #656d76;">
            <div style="display: inline-block; animation: spin 1s linear infinite; font-size: 1.5rem; margin-bottom: 1rem;">‚è≥</div>
            <div style="font-size: 0.95rem;">Loading...</div>
          </li>
        `;
      } else if (currentView === 'problems') {
        // Problems view loading
        document.getElementById('mobile-file-list').innerHTML = `
          <li style="text-align: center; padding: 2rem; color: #656d76;">
            <div style="display: inline-block; animation: spin 1s linear infinite; font-size: 1.5rem; margin-bottom: 1rem;">‚è≥</div>
            <div style="font-size: 0.95rem;">Loading...</div>
          </li>
        `;
      } else if (currentView === 'content') {
        // Content view loading
        document.getElementById('mobile-content').innerHTML = `
          <div class="mobile-content-inner">
            <div style="text-align: center; padding: 3rem 1rem; color: #656d76;">
              <div style="display: inline-block; animation: spin 1s linear infinite; font-size: 1.5rem; margin-bottom: 1rem;">‚è≥</div>
              <p style="margin: 0; font-size: 0.95rem;">Loading...</p>
            </div>
          </div>
        `;
      }
    }
    
    // Load lists (same logic as desktop)
    async function loadMobileLists() {
      try {
        const response = await fetch('data/lists.json');
        currentLists = await response.json();
        
        const { slugMap, fileMap } = generateSlugMappings(currentLists);
        listSlugMap = slugMap;
        slugToFileMap = fileMap;
        
        renderMobileLists();
      } catch (error) {
        console.error('Failed to load lists:', error);
        document.getElementById('mobile-lists-list').innerHTML = `
          <li style="color: #dc3545; padding: 1em;">Failed to load practice lists</li>
        `;
      }
    }
    
    // Render mobile lists
    function renderMobileLists() {
      const listsList = document.getElementById('mobile-lists-list');
      listsList.innerHTML = '';
      
      currentLists.forEach(list => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        const listSlug = listSlugMap[list.file];
        
        a.href = `#${listSlug}`;
        a.innerHTML = `
          <span class="mobile-list-icon">${getMobileListIcon(list.name)}</span>
          <span class="mobile-list-text">${list.name}</span>
          <span class="mobile-list-arrow">‚Üí</span>
        `;
        
        a.onclick = (e) => {
          e.preventDefault();
          showMobileLoadingAnimation();
          setTimeout(() => {
            mobileRouter.navigate(listSlug);
          }, 300);
        };
        
        li.appendChild(a);
        listsList.appendChild(li);
      });
      
      // Animate the lists container
      animateMobileContentContainer('mobile-lists-list', 'fade-in');
    }
    
    // Render mobile lists without animation (for router transitions)
    function renderMobileListsNoAnimation() {
      const listsList = document.getElementById('mobile-lists-list');
      listsList.innerHTML = '';
      
      currentLists.forEach(list => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        const listSlug = listSlugMap[list.file];
        
        a.href = `#${listSlug}`;
        a.innerHTML = `
          <span class="mobile-list-icon">${getMobileListIcon(list.name)}</span>
          <span class="mobile-list-text">${list.name}</span>
          <span class="mobile-list-arrow">‚Üí</span>
        `;
        
        a.onclick = (e) => {
          e.preventDefault();
          showMobileLoadingAnimation();
          setTimeout(() => {
            mobileRouter.navigate(listSlug);
          }, 300);
        };
        
        li.appendChild(a);
        listsList.appendChild(li);
      });
      // No animation - view transition already handled by showMobileView
    }
    
    // Get list icon (same as desktop concept)
    function getMobileListIcon(listName) {
      if (listName.includes('75')) return 'üìã';
      if (listName.includes('Easy')) return 'üü¢';
      if (listName.includes('Medium')) return 'üü°';
      if (listName.includes('Hard')) return 'üî¥';
      if (listName.includes('Google')) return 'üîç';
      if (listName.includes('Meta')) return 'üë•';
      if (listName.includes('Amazon')) return 'üì¶';
      if (listName.includes('Microsoft')) return 'ü™ü';
      if (listName.includes('Apple')) return 'üçé';
      if (listName.includes('DSA')) return 'üßÆ';
      if (listName.includes('Handbook')) return 'üìö';
      return 'üìù';
    }
    
    // Load code list files (adapted from desktop)
    async function loadMobileCodeListFiles(jsonFile) {
      const newListSlug = listSlugMap[jsonFile];
      const isNewList = (currentListSlug !== newListSlug);
      
      try {
        const response = await fetch(`data/${jsonFile}`);
        const list = await response.json();
        
        // Ensure all problems have slugs (generate if missing)
        list.forEach(problem => {
          if (!problem.slug) {
            problem.slug = createSlug(problem.title);
          }
        });
        
        currentListData = list;
        currentListSlug = newListSlug;
        
        renderMobileProblems();
        
        if (isNewList && !isPageReload) {
          document.getElementById('mobile-sidebar').scrollTop = 0;
          currentMarkdownFile = '';
        }
      } catch (error) {
        console.error('Failed to load code list:', error);
      }
    }
    
    // Load code list files without animation (for router transitions)
    async function loadMobileCodeListFilesNoAnimation(jsonFile) {
      const newListSlug = listSlugMap[jsonFile];
      const isNewList = (currentListSlug !== newListSlug);
      
      try {
        const response = await fetch(`data/${jsonFile}`);
        const list = await response.json();
        
        // Ensure all problems have slugs (generate if missing)
        list.forEach(problem => {
          if (!problem.slug) {
            problem.slug = createSlug(problem.title);
          }
        });
        
        currentListData = list;
        currentListSlug = newListSlug;
        
        renderMobileProblemsNoAnimation();
        
        if (isNewList && !isPageReload) {
          document.getElementById('mobile-sidebar').scrollTop = 0;
          currentMarkdownFile = '';
        }
      } catch (error) {
        console.error('Failed to load code list:', error);
      }
    }
    
    // Render mobile problems
    function renderMobileProblems() {
      const fileList = document.getElementById('mobile-file-list');
      fileList.innerHTML = '';
      
      currentListData.forEach(item => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        const problemUrl = `#${currentListSlug}/${item.slug}`;
        
        a.href = problemUrl;
        a.innerHTML = `
          <span class="mobile-problem-number">#${item.number}</span>
          <span class="mobile-problem-title">${item.title}</span>
          <span class="mobile-problem-difficulty ${item.difficulty.toLowerCase()}">${item.difficulty}</span>
        `;
        
        a.onclick = (e) => {
          e.preventDefault();
          
          // Immediately switch to content view and show content loading
          currentView = 'content';
          showMobileView('content');
          showMobileLoadingAnimation();
          document.title = `${item.title} - LeetCode Prep`;
          
          // Navigate to new problem with controlled timing
          setTimeout(() => {
            mobileRouter.navigate(currentListSlug, item.slug);
          }, 300);
        };
        
        li.appendChild(a);
        fileList.appendChild(li);
      });
      
      // Animate the problems list container
      animateMobileContentContainer('mobile-file-list', 'slide-in');
    }
    
    // Render mobile problems without animation (for router transitions)
    function renderMobileProblemsNoAnimation() {
      const fileList = document.getElementById('mobile-file-list');
      fileList.innerHTML = '';
      
      currentListData.forEach(item => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        const problemUrl = `#${currentListSlug}/${item.slug}`;
        
        a.href = problemUrl;
        a.innerHTML = `
          <span class="mobile-problem-number">#${item.number}</span>
          <span class="mobile-problem-title">${item.title}</span>
          <span class="mobile-problem-difficulty ${item.difficulty.toLowerCase()}">${item.difficulty}</span>
        `;
        
        a.onclick = (e) => {
          e.preventDefault();
          
          // Immediately switch to content view and show content loading
          currentView = 'content';
          showMobileView('content');
          showMobileLoadingAnimation();
          document.title = `${item.title} - LeetCode Prep`;
          
          // Navigate to new problem with controlled timing
          setTimeout(() => {
            mobileRouter.navigate(currentListSlug, item.slug);
          }, 300);
        };
        
        li.appendChild(a);
        fileList.appendChild(li);
      });
      // No animation - view transition already handled by showMobileView
    }
    
    // Load markdown file (adapted from desktop)
    async function loadMobileMarkdownFile(filename) {
      currentMarkdownFile = filename;
      
      // Don't show loading animation here - it's handled by navigation
      
      try {
        const response = await fetch(`md/${filename}`);
        
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: File not found`);
        }
        
        const md = await response.text();
        const enhancedMd = enhanceMobileMarkdown(md);
        
        const navigationButtons = generateMobileNavigationButtons(filename);
        
        document.getElementById('mobile-content').innerHTML = `
          <div class="mobile-content-inner">
            ${navigationButtons.top}
            ${marked.parse(enhancedMd)}
            <div class="mobile-author-footnote">
              Made with <span class="heart">‚ô•</span> by Durga Ganesh using AI
            </div>
          </div>
        `;
        
        addMobileDifficultyBadges();
        setupMobileNavigationListeners();
        
        document.querySelectorAll('pre code').forEach((block) => {
          hljs.highlightElement(block);
        });
        
        document.getElementById('mobile-content').scrollTop = 0;
        
        // Animate the content container
        const contentInner = document.querySelector('.mobile-content-inner');
        if (contentInner) {
          animateMobileContent(contentInner, 'fade-in');
        }
        
      } catch (error) {
        document.getElementById('mobile-content').innerHTML = `
          <div class="mobile-content-inner">
            <h2>File Not Found</h2>
            <p>The requested markdown file "<strong>${filename}</strong>" does not exist.</p>
            <p>Error: ${error.message}</p>
            <p><a href="#" onclick="mobileRouter.navigate(currentListSlug)">‚Üê Back to Problems</a></p>
          </div>
        `;
        document.title = 'File Not Found - LeetCode Prep';
      }
    }
    
    // Enhanced markdown processing (add difficulty badges like desktop and format title)
    function enhanceMobileMarkdown(md) {
      // First, clean up any existing malformed difficulty badges
      md = md.replace(/<span class="difficulty-badge [^"]*<span[^>]*>[^<]*<\/span>[^"]*"[^>]*>/g, '');
      md = md.replace(/class="difficulty-badge [^"]*"[^>]*>[^<]*<\/span>">/g, '');
      
      // Transform title to match desktop format: {difficulty} LeetCode {number}: {title} [Practice](link)
      md = md.replace(/### Leetcode (\d+) \((Easy|Medium|Hard)\): ([^[]+) \[Practice\]\(([^)]+)\)/g, 
        function(match, number, difficulty, title, practiceLink) {
          const difficultyLower = difficulty.toLowerCase();
          return `<h3><span class="difficulty-badge ${difficultyLower}">${difficulty}</span> LeetCode ${number}: ${title.trim()} <a href="${practiceLink}" target="_blank" rel="noopener noreferrer" style="background: #0969da; color: white; border: none; padding: 0.2em 0.5em; border-radius: 3px; cursor: pointer; font-weight: 500; font-size: 0.65em; text-decoration: none; display: inline-block; margin-left: 0.5em;">Practice</a></h3>`;
        });
      
      // Enhance explanation formatting (add bulb icon like desktop)
      md = md.replace(/\*Explanation:/g, 
        'üí° *Explanation:');
      
      // Add hint icon for hints (add bulb icon like desktop)
      md = md.replace(/\*Hint:/g, 
        'üí° *Hint:');
      
      return md;
    }
    
    // Generate mobile navigation buttons (matching desktop styling)
    function generateMobileNavigationButtons(filename) {
      const currentIndex = currentListData.findIndex(p => 
        `${p.number}-${p.slug}.md` === filename
      );
      
      const prevButton = currentIndex > 0 ? 
        `<button id="mobile-prev-btn" style="background: #6f42c1; color: white; border: none; padding: 0.2em 0.5em; border-radius: 3px; cursor: pointer; font-weight: 500; font-size: 0.65em; display: inline-flex; align-items: center; justify-content: center; min-height: 20px; line-height: 1; vertical-align: middle;"><span style="display: inline-flex; align-items: center;">‚Üê Prev</span></button>` :
        `<button disabled style="background: #f6f8fa; color: #8c959f; border: 1px solid #e1e5e9; padding: 0.2em 0.5em; border-radius: 3px; cursor: not-allowed; font-weight: 500; font-size: 0.65em; display: inline-flex; align-items: center; justify-content: center; min-height: 20px; line-height: 1; vertical-align: middle;"><span style="display: inline-flex; align-items: center;">‚Üê Prev</span></button>`;
      
      const nextButton = currentIndex < currentListData.length - 1 ?
        `<button id="mobile-next-btn" style="background: #6f42c1; color: white; border: none; padding: 0.2em 0.5em; border-radius: 3px; cursor: pointer; font-weight: 500; font-size: 0.65em; display: inline-flex; align-items: center; justify-content: center; min-height: 20px; line-height: 1; vertical-align: middle;"><span style="display: inline-flex; align-items: center;">Next ‚Üí</span></button>` :
        `<button disabled style="background: #f6f8fa; color: #8c959f; border: 1px solid #e1e5e9; padding: 0.2em 0.5em; border-radius: 3px; cursor: not-allowed; font-weight: 500; font-size: 0.65em; display: inline-flex; align-items: center; justify-content: center; min-height: 20px; line-height: 1; vertical-align: middle;"><span style="display: inline-flex; align-items: center;">Next ‚Üí</span></button>`;
      
      return {
        top: `
          <div class="mobile-action-buttons">
            ${prevButton}
            <span style="color: #656d76; font-size: 0.7em; margin: 0 0.5em;">${currentIndex + 1} of ${currentListData.length}</span>
            ${nextButton}
            <button id="mobile-print-btn" onclick="window.print()" style="background: #0969da; color: white; border: none; padding: 0.2em 0.5em; border-radius: 3px; cursor: pointer; font-weight: 500; font-size: 0.65em; display: inline-flex; align-items: center; justify-content: center; min-height: 20px; line-height: 1; vertical-align: middle; margin-left: 0.5em;">üñ®Ô∏è Print</button>
          </div>
        `
      };
    }
    
    // Add difficulty badges
    function addMobileDifficultyBadges() {
      document.querySelectorAll('.difficulty-badge').forEach(badge => {
        const difficulty = badge.textContent.toLowerCase();
        badge.classList.add(difficulty);
      });
    }
    
    // Setup navigation listeners
    function setupMobileNavigationListeners() {
      const prevBtn = document.getElementById('mobile-prev-btn');
      const nextBtn = document.getElementById('mobile-next-btn');
      
      if (prevBtn) {
        prevBtn.onclick = () => navigateToMobileAdjacentProblem(-1);
      }
      
      if (nextBtn) {
        nextBtn.onclick = () => navigateToMobileAdjacentProblem(1);
      }
    }
    
    // Navigate to adjacent problem (with loading animation)
    function navigateToMobileAdjacentProblem(direction) {
      const { problemSlug } = mobileRouter.parseHash();
      const currentIndex = currentListData.findIndex(p => p.slug === problemSlug);
      
      if (currentIndex === -1) return;
      
      const newIndex = currentIndex + direction;
      if (newIndex >= 0 && newIndex < currentListData.length) {
        const newProblem = currentListData[newIndex];
        
        // Show loading animation immediately (no exit animation for smoother experience)
        showMobileLoadingAnimation();
        document.title = `${newProblem.title} - LeetCode Prep`;
        
        // Navigate to new problem with controlled timing
        setTimeout(() => {
          mobileRouter.navigate(currentListSlug, newProblem.slug);
        }, 300);
      }
    }
    
    // Mobile event handlers
    function setupMobileEventHandlers() {
      // Navigation buttons - always show loading animation
      document.getElementById('mobile-home-btn').onclick = () => {
        showMobileLoadingAnimation();
        setTimeout(() => {
          mobileRouter.navigate('');
        }, 300);
      };
      
      document.getElementById('mobile-search-btn').onclick = () => {
        openMobileSearchModal();
      };
      
      document.getElementById('mobile-settings-btn').onclick = () => {
        openMobileSettingsModal();
      };
      
      document.getElementById('mobile-feedback-fab').onclick = () => {
        openMobileFeedback();
      };
      
      document.getElementById('mobile-share-fab').onclick = () => {
        shareMobileUrl(window.location.href, document.title);
      };
    }
    
    // Filter problems (mobile)
    function filterMobileProblems(searchTerm) {
      const fileList = document.getElementById('mobile-file-list');
      const items = fileList.querySelectorAll('li');
      
      items.forEach(item => {
        const text = item.textContent.toLowerCase();
        const matches = searchTerm === '' || text.includes(searchTerm.toLowerCase());
        item.style.display = matches ? 'block' : 'none';
      });
    }
    
    // Mobile search modal
    function openMobileSearchModal() {
      document.getElementById('mobile-search-modal').style.display = 'block';
    }
    
    function closeMobileSearchModal() {
      document.getElementById('mobile-search-modal').style.display = 'none';
    }
    
    // Mobile settings modal
    function openMobileSettingsModal() {
      document.getElementById('mobile-settings-modal').style.display = 'block';
    }
    
    function closeMobileSettingsModal() {
      document.getElementById('mobile-settings-modal').style.display = 'none';
    }
    
    // Share URL function (updated to match desktop version)
    function shareMobileUrl(url, title) {
      if (navigator.share) {
        // Use native sharing if available
        navigator.share({
          title: title,
          url: url
        }).then(() => {
          showMobileToast('Shared successfully!');
        }).catch((error) => {
          // If native share fails or is cancelled, fall back to clipboard
          console.log('Native share failed:', error);
          fallbackToClipboard(url);
        });
      } else {
        // No native share support, use clipboard
        fallbackToClipboard(url);
      }
    }
    
    // Fallback clipboard function
    function fallbackToClipboard(url) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(url).then(() => {
          showMobileToast('Link copied to clipboard!');
        }).catch(() => {
          showMobileToast(`Share: ${url}`);
        });
      } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = url;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
          document.execCommand('copy');
          showMobileToast('Link copied to clipboard!');
        } catch (err) {
          showMobileToast(`Share: ${url}`);
        }
        document.body.removeChild(textArea);
      }
    }
    
    // Open mobile feedback (matching desktop version)
    function openMobileFeedback() {
      let pageTitle = document.title.replace(' - LeetCode Prep', '');
      let pageUrl = window.location.href;
      let body = `**Feedback for:** ${pageTitle}\n\n**Page:** ${pageUrl}\n\n**Feedback:**\n`;
      let issueUrl =
        'https://github.com/structured-lc/structured-lc.github.io/issues/new' +
        '?title=' + encodeURIComponent('Feedback: ' + pageTitle) +
        '&body=' + encodeURIComponent(body) +
        '&labels=feedback';
      window.open(issueUrl, '_blank');
    }    // Show mobile toast
    function showMobileToast(message) {
      const toast = document.createElement('div');
      toast.className = 'mobile-toast';
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.classList.add('show'), 100);
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    
    // Initialize mobile app
    document.addEventListener('DOMContentLoaded', async () => {
      setupMobileEventHandlers();
      await loadMobileLists(); // Load lists first
      mobileRouter.init(); // Then initialize router, which will handle the current URL
    });
  </script>
</body>
</html>
